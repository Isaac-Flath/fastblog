<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Random Forest Classifier | Isaac’s Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Random Forest Classifier" />
<meta name="author" content="Isaac Flath" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Machine Learning - The basics of building a decent binary classifier on tabular data" />
<meta property="og:description" content="Machine Learning - The basics of building a decent binary classifier on tabular data" />
<link rel="canonical" href="https://isaac-flath.github.io/fastblog/tree%20ensembles/2020/05/11/RandomForestClassifier.html" />
<meta property="og:url" content="https://isaac-flath.github.io/fastblog/tree%20ensembles/2020/05/11/RandomForestClassifier.html" />
<meta property="og:site_name" content="Isaac’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-05-11T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://isaac-flath.github.io/fastblog/tree%20ensembles/2020/05/11/RandomForestClassifier.html","@type":"BlogPosting","headline":"Random Forest Classifier","dateModified":"2020-05-11T00:00:00-05:00","datePublished":"2020-05-11T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://isaac-flath.github.io/fastblog/tree%20ensembles/2020/05/11/RandomForestClassifier.html"},"author":{"@type":"Person","name":"Isaac Flath"},"description":"Machine Learning - The basics of building a decent binary classifier on tabular data","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/fastblog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://isaac-flath.github.io/fastblog/feed.xml" title="Isaac's Blog" /><link rel="shortcut icon" type="image/x-icon" href="/fastblog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/fastblog/">Isaac&#39;s Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/fastblog/about/">About Me</a><a class="page-link" href="/fastblog/search/">Search</a><a class="page-link" href="/fastblog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Random Forest Classifier</h1><p class="page-description">Machine Learning - The basics of building a decent binary classifier on tabular data</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-05-11T00:00:00-05:00" itemprop="datePublished">
        May 11, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Isaac Flath</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      10 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/fastblog/categories/#Tree Ensembles">Tree Ensembles</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/Isaac-Flath/fastblog/tree/master/_notebooks/2020-05-11-RandomForestClassifier.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/fastblog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/Isaac-Flath/fastblog/master?filepath=_notebooks%2F2020-05-11-RandomForestClassifier.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/fastblog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/Isaac-Flath/fastblog/blob/master/_notebooks/2020-05-11-RandomForestClassifier.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/fastblog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#Goal">Goal </a></li>
<li class="toc-entry toc-h1"><a href="#Setup">Setup </a></li>
<li class="toc-entry toc-h1"><a href="#Data-Setup">Data Setup </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Dependent-Variable">Dependent Variable </a></li>
<li class="toc-entry toc-h3"><a href="#Training-and-Validation-Set-Split">Training and Validation Set Split </a></li>
<li class="toc-entry toc-h3"><a href="#Dates">Dates </a></li>
<li class="toc-entry toc-h3"><a href="#Categorical-Variables">Categorical Variables </a>
<ul>
<li class="toc-entry toc-h5"><a href="#Ordinal-Categorical-Variables">Ordinal Categorical Variables </a></li>
<li class="toc-entry toc-h5"><a href="#Categorical-Variables-Final">Categorical Variables Final </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#Final-Change">Final Change </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Random-Forest-Model">Random Forest Model </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Initial-Model">Initial Model </a></li>
<li class="toc-entry toc-h3"><a href="#Model-Tuning---Grid-Search">Model Tuning - Grid Search </a></li>
<li class="toc-entry toc-h3"><a href="#Results">Results </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Model-Minimizing">Model Minimizing </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Feature-Importance">Feature Importance </a></li>
<li class="toc-entry toc-h3"><a href="#Remove-Low-Important-Variables">Remove Low Important Variables </a></li>
<li class="toc-entry toc-h3"><a href="#Results">Results </a></li>
<li class="toc-entry toc-h3"><a href="#Redundant-columns">Redundant columns </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-11-RandomForestClassifier.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Goal">
<a class="anchor" href="#Goal" aria-hidden="true"><span class="octicon octicon-link"></span></a>Goal<a class="anchor-link" href="#Goal"> </a>
</h1>
<p>The goal is to predict whether a passenger on the Titanic survived or not.  The applications for binary classification are endless and could be applied to many real world problems.  Does this patient have this disease?  Will this customer Churn?  Will price go up?  These are just a few examples.</p>
<p>The purpose is to give a general guide to classification.  If you get through this and want more detail, I highly recommend checking out the Tabular Chapter of Deep Learning for Coders with fastai &amp; Pytorch by Jeremy Howard and Sylvain Gugger.  The book primarily focuses on deep learning, though decision trees are covered for tabular data.  All of the material in this guide and more is covered in much greater detail in that book.</p>
<p><a href="https://www.amazon.com/Deep-Learning-Coders-fastai-PyTorch/dp/1492045527">https://www.amazon.com/Deep-Learning-Coders-fastai-PyTorch/dp/1492045527</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Setup">
<a class="anchor" href="#Setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setup<a class="anchor-link" href="#Setup"> </a>
</h1>
<p>We are going to start with loading libraries and datasets that are needed.  I am going to skip over this as they are pretty self explanatory, but feel free to look close if you would like.</p>
<p>I am going to use Seaborn to load the Titanic dataset.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">fastai2.tabular.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai2</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">dtreeviz.trees</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy.cluster</span> <span class="kn">import</span> <span class="n">hierarchy</span> <span class="k">as</span> <span class="n">hc</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">'titanic'</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>C</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Cherbourg</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>S</td>
      <td>Third</td>
      <td>woman</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>True</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>S</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Data-Setup">
<a class="anchor" href="#Data-Setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data Setup<a class="anchor-link" href="#Data-Setup"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Dependent-Variable">
<a class="anchor" href="#Dependent-Variable" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dependent Variable<a class="anchor-link" href="#Dependent-Variable"> </a>
</h3>
<p>We want to define what we are predicting, or the dependent variable.  We also see that 'Survived' and 'alive' columns are the same thing with different names.  We need to get rid of one and predict the other.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'survived'</span><span class="p">,</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">dep_var</span> <span class="o">=</span> <span class="s1">'alive'</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training-and-Validation-Set-Split">
<a class="anchor" href="#Training-and-Validation-Set-Split" aria-hidden="true"><span class="octicon octicon-link"></span></a>Training and Validation Set Split<a class="anchor-link" href="#Training-and-Validation-Set-Split"> </a>
</h3>
<p>Best practice is to minimally have a training and validation set.  Those are the 2 that we will use for this tutorial.</p>
<ul>
<li>Training Set:  This is what the model actually trains on</li>
<li>Validation Set:  This is used to gauge success of the Training</li>
<li>Test Set:  This is a held out of the total process to be an additional safeguard against overfitting</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span><span class="o">&gt;.</span><span class="mi">2</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cond</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">valid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">cond</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">splits</span> <span class="o">=</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">train</span><span class="p">),</span><span class="nb">list</span><span class="p">(</span><span class="n">valid</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Dates">
<a class="anchor" href="#Dates" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dates<a class="anchor-link" href="#Dates"> </a>
</h3>
<p>We don't have any dates to deal with, but if we did we would do the following:</p>
<p><code>df = add_datepart(df,'date')</code></p>
<p>This would replace that date with a ton of different columns, such as the year, the day number, the day of the week, is it month end, is it month start, and more.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Categorical-Variables">
<a class="anchor" href="#Categorical-Variables" aria-hidden="true"><span class="octicon octicon-link"></span></a>Categorical Variables<a class="anchor-link" href="#Categorical-Variables"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Ordinal-Categorical-Variables">
<a class="anchor" href="#Ordinal-Categorical-Variables" aria-hidden="true"><span class="octicon octicon-link"></span></a>Ordinal Categorical Variables<a class="anchor-link" href="#Ordinal-Categorical-Variables"> </a>
</h5>
<p>Some categorical variables have a natural heirarchy.  By telling pandas the order it tends to mean trees don't have to split as many times, which speeds up training times.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">'class'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[Third, First, Second]
Categories (3, object): [Third, First, Second]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">classes</span> <span class="o">=</span> <span class="s1">'First'</span><span class="p">,</span><span class="s1">'Second'</span><span class="p">,</span><span class="s1">'Third'</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">'class'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'class'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'category'</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'class'</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">set_categories</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Categorical-Variables-Final">
<a class="anchor" href="#Categorical-Variables-Final" aria-hidden="true"><span class="octicon octicon-link"></span></a>Categorical Variables Final<a class="anchor-link" href="#Categorical-Variables-Final"> </a>
</h5>
<p>We are now going to do some data cleaning.  The Categorify and FillMissing functions in the fastai2 library make this easy.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">procs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cont</span><span class="p">,</span><span class="n">cat</span> <span class="o">=</span> <span class="n">cont_cat_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dep_var</span><span class="o">=</span><span class="n">dep_var</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">procs</span><span class="p">,</span> <span class="n">cat</span><span class="p">,</span> <span class="n">cont</span><span class="p">,</span> <span class="n">y_names</span><span class="o">=</span><span class="n">dep_var</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's take a look at the training and validation sets and make sure we have a good split of each.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(713, 178)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now take a look and see that while we see all the same data, behind the scenes it is all numeric.  This is exactly what we need for our random forest.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alone</th>
      <th>age_na</th>
      <th>pclass</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>alive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>male</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>#na#</td>
      <td>Southampton</td>
      <td>False</td>
      <td>False</td>
      <td>3.0</td>
      <td>22.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>7.250000</td>
      <td>no</td>
    </tr>
    <tr>
      <th>3</th>
      <td>female</td>
      <td>S</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Southampton</td>
      <td>False</td>
      <td>False</td>
      <td>1.0</td>
      <td>35.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>53.099998</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>4</th>
      <td>male</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>#na#</td>
      <td>Southampton</td>
      <td>True</td>
      <td>False</td>
      <td>3.0</td>
      <td>35.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.050000</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
      <th>age_na</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>3.0</td>
      <td>2</td>
      <td>22.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>7.250000</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.0</td>
      <td>1</td>
      <td>35.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>53.099998</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>4</td>
      <td>3.0</td>
      <td>2</td>
      <td>35.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.050000</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Final-Change">
<a class="anchor" href="#Final-Change" aria-hidden="true"><span class="octicon octicon-link"></span></a>Final Change<a class="anchor-link" href="#Final-Change"> </a>
</h3>
<p>Finally, we will put just the data in xs and ys so they are in easy format to pass to models.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xs</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span><span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">y</span>
<span class="n">valid_xs</span><span class="p">,</span><span class="n">valid_y</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">valid</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span><span class="n">to</span><span class="o">.</span><span class="n">valid</span><span class="o">.</span><span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Random-Forest-Model">
<a class="anchor" href="#Random-Forest-Model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Random Forest Model<a class="anchor-link" href="#Random-Forest-Model"> </a>
</h1>
<h3 id="Initial-Model">
<a class="anchor" href="#Initial-Model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Initial Model<a class="anchor-link" href="#Initial-Model"> </a>
</h3>
<p>Let's start by creating a model without tuning and see how it does</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[445,   1],
       [  5, 262]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looking pretty good!  Only 6 wrong.  Let's see how it did on the validation set.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_xs</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[89, 14],
       [26, 49]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Still way better than 50/50, but not quite as good.  This is because the model did not train based on this validation data so it doesn't perform nearly as well.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Model-Tuning---Grid-Search">
<a class="anchor" href="#Model-Tuning---Grid-Search" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model Tuning - Grid Search<a class="anchor-link" href="#Model-Tuning---Grid-Search"> </a>
</h3>
<p>We made our first model, and it doesn't seem to predict as well as we would like.  Let's do something about that.</p>
<p>We are going to do a grid search.  There are many more sophisticated ways to find parameters (maybe a future post), but the grid search is easy to understand.  Basically you pick some ranges, and you try them all to see what works best.</p>
<p>We will use the built in gridsearch.  All we need to do is define the range of parameters, and let it find the best model.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'n_estimators'</span><span class="p">:</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> 
              <span class="s1">'max_depth'</span><span class="p">:</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span>
              <span class="s1">'min_samples_split'</span><span class="p">:</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
              <span class="s1">'max_features'</span><span class="p">:[</span><span class="s1">'auto'</span><span class="p">,</span><span class="s1">'log2'</span><span class="p">]}</span>             
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">RandomForestClassifier</span><span class="p">(),</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>GridSearchCV(cv='warn', error_score='raise-deprecating',
             estimator=RandomForestClassifier(bootstrap=True, class_weight=None,
                                              criterion='gini', max_depth=None,
                                              max_features='auto',
                                              max_leaf_nodes=None,
                                              min_impurity_decrease=0.0,
                                              min_impurity_split=None,
                                              min_samples_leaf=1,
                                              min_samples_split=2,
                                              min_weight_fraction_leaf=0.0,
                                              n_estimators='warn', n_jobs=None,
                                              oob_score=False,
                                              random_state=None, verbose=0,
                                              warm_start=False),
             iid='warn', n_jobs=-1,
             param_grid={'max_depth': range(10, 20, 20),
                         'max_features': ['auto', 'log2'],
                         'min_samples_split': range(2, 20),
                         'n_estimators': range(10, 20, 20)},
             pre_dispatch='2*n_jobs', refit=True, return_train_score=False,
             scoring=None, verbose=0)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Results">
<a class="anchor" href="#Results" aria-hidden="true"><span class="octicon octicon-link"></span></a>Results<a class="anchor-link" href="#Results"> </a>
</h3>
<p>We can see below that the best esimator works better for prediciton the validation set than the model above did.  Success!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">clf</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[431,  15],
       [ 43, 224]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span><span class="n">clf</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_xs</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[95,  8],
       [25, 50]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Model-Minimizing">
<a class="anchor" href="#Model-Minimizing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model Minimizing<a class="anchor-link" href="#Model-Minimizing"> </a>
</h1>
<p>Now that we have good results with a tuned model, we may want to simplify the model.  If we can simplify the model without significantly impacting accuracy, that's good for many reasons.</p>
<ol>
<li>The model is easier to understand</li>
<li>Fewer variables means fewer data quality issues and more focused data quality efforts</li>
<li>It takes less resources and time to run</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Feature-Importance">
<a class="anchor" href="#Feature-Importance" aria-hidden="true"><span class="octicon octicon-link"></span></a>Feature Importance<a class="anchor-link" href="#Feature-Importance"> </a>
</h3>
<p>There are many ways to measure importance.  How often do we use a feature to split?  How high up in the tree is it used to split?  We are going to use scikit learns feature importance information.</p>
<p>Let's look at what features are!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">rf_feat_importance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'cols'</span><span class="p">:</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s1">'imp'</span><span class="p">:</span><span class="n">m</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">}</span>
                       <span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'imp'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fi</span> <span class="o">=</span> <span class="n">rf_feat_importance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
<span class="n">fi</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cols</th>
      <th>imp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>13</td>
      <td>fare</td>
      <td>0.205103</td>
    </tr>
    <tr>
      <td>10</td>
      <td>age</td>
      <td>0.198317</td>
    </tr>
    <tr>
      <td>4</td>
      <td>adult_male</td>
      <td>0.104956</td>
    </tr>
    <tr>
      <td>0</td>
      <td>sex</td>
      <td>0.097934</td>
    </tr>
    <tr>
      <td>3</td>
      <td>who</td>
      <td>0.094934</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Alright so we see that the most important variable is how much the passenger paid for their fare.  Lovely.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_fi</span><span class="p">(</span><span class="n">fi</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">fi</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">'cols'</span><span class="p">,</span> <span class="s1">'imp'</span><span class="p">,</span> <span class="s1">'barh'</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plot_fi</span><span class="p">(</span><span class="n">fi</span><span class="p">[:</span><span class="mi">30</span><span class="p">]);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Remove-Low-Important-Variables">
<a class="anchor" href="#Remove-Low-Important-Variables" aria-hidden="true"><span class="octicon octicon-link"></span></a>Remove Low Important Variables<a class="anchor-link" href="#Remove-Low-Important-Variables"> </a>
</h3>
<p>This isn't strictly neccesarry, but it is nice to simplify models if you can.  Simpler models are easier to understand and maintain, and they take less resources to run.  It is also interesting to know just how many variables are needed to predict.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to_keep</span> <span class="o">=</span> <span class="n">fi</span><span class="p">[</span><span class="n">fi</span><span class="o">.</span><span class="n">imp</span><span class="o">&gt;</span><span class="mf">0.045</span><span class="p">]</span><span class="o">.</span><span class="n">cols</span>
<span class="nb">len</span><span class="p">(</span><span class="n">to_keep</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>8</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xs_imp</span> <span class="o">=</span> <span class="n">xs</span><span class="p">[</span><span class="n">to_keep</span><span class="p">]</span>
<span class="n">valid_xs_imp</span> <span class="o">=</span> <span class="n">valid_xs</span><span class="p">[</span><span class="n">to_keep</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">RandomForestClassifier</span><span class="p">(),</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">xs_imp</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>GridSearchCV(cv='warn', error_score='raise-deprecating',
             estimator=RandomForestClassifier(bootstrap=True, class_weight=None,
                                              criterion='gini', max_depth=None,
                                              max_features='auto',
                                              max_leaf_nodes=None,
                                              min_impurity_decrease=0.0,
                                              min_impurity_split=None,
                                              min_samples_leaf=1,
                                              min_samples_split=2,
                                              min_weight_fraction_leaf=0.0,
                                              n_estimators='warn', n_jobs=None,
                                              oob_score=False,
                                              random_state=None, verbose=0,
                                              warm_start=False),
             iid='warn', n_jobs=-1,
             param_grid={'max_depth': range(10, 20, 20),
                         'max_features': ['auto', 'log2'],
                         'min_samples_split': range(2, 20),
                         'n_estimators': range(10, 20, 20)},
             pre_dispatch='2*n_jobs', refit=True, return_train_score=False,
             scoring=None, verbose=0)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Results">
<a class="anchor" href="#Results" aria-hidden="true"><span class="octicon octicon-link"></span></a>Results<a class="anchor-link" href="#Results"> </a>
</h3>
<p>Now we see with only 8 features we still get pretty good results on on validation set.</p>
<p>Now the question is whether this small loss in accuracy outweighed by a simpler and more efficient model?  That is a business question more than it is a data science question.</p>
<p>If you are detecting COVID-19, you probably want it to be as accurate as possible.  If you are going to predict whether someone is a cat or a dog person based on a survey for marketing purposes, small changes in accuracy probably are not as critical.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">clf</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xs_imp</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[422,  24],
       [ 62, 205]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span><span class="n">clf</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_xs_imp</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[98,  5],
       [24, 51]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">best_estimator_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',
                       max_depth=10, max_features='auto', max_leaf_nodes=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=14,
                       min_weight_fraction_leaf=0.0, n_estimators=10,
                       n_jobs=None, oob_score=False, random_state=None,
                       verbose=0, warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Redundant-columns">
<a class="anchor" href="#Redundant-columns" aria-hidden="true"><span class="octicon octicon-link"></span></a>Redundant columns<a class="anchor-link" href="#Redundant-columns"> </a>
</h3>
<p>Of the 6 remaining variables, we can see that some of them are very related.  It makes sense to me that deck and fare are related.  Nicer areas probably cost more.  It makes sense to me that the person's sex has some redudancy with adult_male - the redundancy is even in the name.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">cluster_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">):</span>
    <span class="n">corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">correlation</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">corr_condensed</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">squareform</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">corr</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">linkage</span><span class="p">(</span><span class="n">corr_condensed</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'average'</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">hc</span><span class="o">.</span><span class="n">dendrogram</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">'left'</span><span class="p">,</span> <span class="n">leaf_font_size</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cluster_columns</span><span class="p">(</span><span class="n">xs_imp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now from the chart above, we can clearly see that class and pclass are completely redundant.  We see the sex and adult_male has some redundancy as well.  This makes sense as part of the adult_male column is the sex.  Let's go ahead and drop one of the class or pclass variables (they are redundant so doesn't matter which).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xs_imp</span> <span class="o">=</span> <span class="n">xs_imp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'pclass'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">valid_xs_imp</span> <span class="o">=</span> <span class="n">valid_xs_imp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'pclass'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xs_imp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fare</th>
      <th>age</th>
      <th>adult_male</th>
      <th>sex</th>
      <th>who</th>
      <th>deck</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>7.250000</td>
      <td>22.0</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <td>3</td>
      <td>53.099998</td>
      <td>35.0</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <td>4</td>
      <td>8.050000</td>
      <td>35.0</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <td>5</td>
      <td>8.458300</td>
      <td>28.0</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <td>6</td>
      <td>51.862499</td>
      <td>54.0</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>5</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">xs_imp</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>GridSearchCV(cv='warn', error_score='raise-deprecating',
             estimator=RandomForestClassifier(bootstrap=True, class_weight=None,
                                              criterion='gini', max_depth=None,
                                              max_features='auto',
                                              max_leaf_nodes=None,
                                              min_impurity_decrease=0.0,
                                              min_impurity_split=None,
                                              min_samples_leaf=1,
                                              min_samples_split=2,
                                              min_weight_fraction_leaf=0.0,
                                              n_estimators='warn', n_jobs=None,
                                              oob_score=False,
                                              random_state=None, verbose=0,
                                              warm_start=False),
             iid='warn', n_jobs=-1,
             param_grid={'max_depth': range(10, 20, 20),
                         'max_features': ['auto', 'log2'],
                         'min_samples_split': range(2, 20),
                         'n_estimators': range(10, 20, 20)},
             pre_dispatch='2*n_jobs', refit=True, return_train_score=False,
             scoring=None, verbose=0)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ok, so now on to variables that are not completely redundant.  Let's experiment with removing some columns and see what we get.  We will use accuracy for our metric.</p>
<p>Here is out baseline:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"accuracy: "</span><span class="p">)</span>
<span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span><span class="n">clf</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_xs_imp</span><span class="p">))[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>\
    <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span><span class="n">clf</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_xs_imp</span><span class="p">))[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span><span class="o">/</span>\
    <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span><span class="n">clf</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_xs_imp</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>accuracy: 
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.8258426966292135</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_accuracy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">valid_x</span><span class="p">,</span><span class="n">valid_y</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">'gini'</span><span class="p">,</span>
                       <span class="n">max_depth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">,</span> <span class="n">max_leaf_nodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">min_impurity_decrease</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">min_impurity_split</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                       <span class="n">min_weight_fraction_leaf</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                       <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">xs_imp</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">((</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_xs_imp</span><span class="p">))[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>\
    <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_xs_imp</span><span class="p">))[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span><span class="o">/</span>\
    <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_xs_imp</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will now loop through each of the remaining variables and train a model and print out the accuracy score.</p>
<p>Judging by the scores below, removing any 1 variable does not significantly reduce the accuracy.  This means that we have redundant columns that can likely be trimmed.  Sex seems to be a column we would definitely keep as removing it have the most impact on accuracy.</p>
<p>From this we can remove variables and iterate through to continue simplifying as much as possible.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">variables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">xs_imp</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'drop '</span><span class="o">+</span><span class="n">variable</span><span class="o">+</span><span class="s1">' accuracy:'</span><span class="p">)</span>
    <span class="n">get_accuracy</span><span class="p">(</span><span class="n">xs_imp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                 <span class="n">y</span><span class="p">,</span>
                 <span class="n">valid_xs_imp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                 <span class="n">valid_y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>drop fare accuracy:
0.8539325842696629
drop age accuracy:
0.8258426966292135
drop adult_male accuracy:
0.8370786516853933
drop sex accuracy:
0.8258426966292135
drop who accuracy:
0.8314606741573034
drop deck accuracy:
0.8146067415730337
drop class accuracy:
0.8258426966292135
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="Isaac-Flath/fastblog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/fastblog/tree%20ensembles/2020/05/11/RandomForestClassifier.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/fastblog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/fastblog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/fastblog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>A personal blog of technical topics relating the machine learning</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://twitter.com/isaac_flath" title="isaac_flath"><svg class="svg-icon grey"><use xlink:href="/fastblog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
